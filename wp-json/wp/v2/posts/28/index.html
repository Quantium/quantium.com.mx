{"id":28,"date":"2006-12-05T19:01:58","date_gmt":"2006-12-06T00:01:58","guid":{"rendered":"http:\/\/www.quantium.com.mx\/qlog\/?p=28"},"modified":"2006-12-22T17:41:23","modified_gmt":"2006-12-22T22:41:23","slug":"perspectiva-as1-a-as2","status":"publish","type":"post","link":"http:\/\/www.quantium.com.mx\/2006\/12\/05\/perspectiva-as1-a-as2\/","title":{"rendered":"Perspectiva AS1 a AS2"},"content":{"rendered":"<p>Esta es la respuesta a <a href=\"http:\/\/www.flashla.com\/forums\/viewtopic.php?p=54237#54237\" target=\"_blank\" title=\"&Eacute;rase una vez en un post de flashla\">este post<\/a> de <a href=\"http:\/\/www.flashla.com\" target=\"_blank\" title=\"flashla\">flashla&nbsp;<\/a><\/p>\n<p>La orientaci&oacute;n a objetos es s&oacute;lo para que el c&oacute;digo sea m&aacute;s ordenado, legible y se acerque m&aacute;s a la manera en la que el ser humano concibe la realidad, asi que para transformar tu c&oacute;digo vamos a seguir algunos pasos b&aacute;sicos que s&oacute;lo requieren orden, claridad y un m&iacute;nimo de conocimiento<\/p>\n<p><strong>Arreglar el c&oacute;digo para que est&eacute; ordenado y legible<\/strong>:<\/p>\n<p>Normalizamos variables usando nombres claros, usar nombres de variables consecutivos no es nada bueno, la variable debe de describir perfectamente y con pocos caracteres lo que hace, si es muy dificil es mejor poner comentarios antes de la declaraci&oacute;n.<\/p>\n<p>Revisar la algoritmia es mejor, una divisi&oacute;n siempre es m&aacute;s clara que una multilplicaci&oacute;n por un decimal. Se pueden encontrar valores comunes e introducirlos en variables para que el c&oacute;digo sea m&aacute;s espec&iacute;fico y manejable.<\/p>\n<p>As&iacute; queda el c&oacute;digo:<\/p>\n<p>[ftf]<br \/>\n\/\/Quito todos los _roots<br \/>\n\/\/Declaro todas las variables y agrego las que nos faltan<br \/>\nvar centrex:Number = ciudad._width\/2;<br \/>\nvar centrey:Number = ciudad._height\/2;<br \/>\n\/*<br \/>\n* Cambio el nombre de las variables para que sea m\u00e1s claro<br \/>\n* valor_a : ydist (Distancia Y)<br \/>\n* valor_b : yvect (Vector Y)<br \/>\n* valor_c : xdist (Distancia X)<br \/>\n* valor_d : xvect (Vector X)<br \/>\n*\/<br \/>\nvar xdist:Number = 0;<br \/>\nvar ydist:Number = 0;<br \/>\nvar xvect:Number = 0;<br \/>\nvar yvect:Number = 0;<br \/>\n\/\/Agrego una variable para manejar la relaci\u00f3n de la perspectiva horizontal ( x )<br \/>\nvar persp:Number = -10;<br \/>\n\/\/Aplico el evento (enterFrame) al mc &#8216;ciudad&#8217;<br \/>\nciudad.onEnterFrame = function()<br \/>\n{<br \/>\n \/\/Cambiamos (* -0.1) por (\/ persp)<br \/>\n ydist = (_ymouse &#8211; centrey) \/ persp;<br \/>\n yvect = yvect + ydist;<br \/>\n yvect = yvect * 0.9;<br \/>\n \/\/Cambiamos (* -0.1) por (\/ persp)<br \/>\n xdist = (_xmouse &#8211; centrex) \/ persp;<br \/>\n xvect = xvect + xdist;<br \/>\n xvect = xvect * 0.9;<br \/>\n ciudad.block1._y = (yvect &#8211; ciudad.block1._y) * 0.03;<br \/>\n ciudad.block2._y = (yvect &#8211; ciudad.block2._y) * 0.02;<br \/>\n ciudad.block3._y = (yvect &#8211; ciudad.block3._y) * 0.01;<br \/>\n ciudad.block1._x = (xvect &#8211; ciudad.block1._x) * 0.45;<br \/>\n ciudad.block2._x = (xvect &#8211; ciudad.block2._x) * 0.30;<br \/>\n ciudad.block3._x = (xvect &#8211; ciudad.block3._x) * 0.15;<br \/>\n};<\/p>\n<p>[\/ftf]<\/p>\n<p><strong>Atribuir variables y funciones a quien le correspondan<\/strong>:<\/p>\n<p>Uno de los principios de la orientaci&oacute;n a objetos es el <a href=\"http:\/\/es.wikipedia.org\/wiki\/Encapsulamiento_%28programaci%C3%B3n_orientada_a_objetos%29\" target=\"_blank\" title=\"Encapsulamiento\">Encapsulamiento<\/a>, lo que significa que cada objeto est&aacute; aislado de los dem&aacute;s lo que hace que se encarge el mismo de sus miembros.<\/p>\n<p>Para llevar a cabo esto con lo que tenemos se corta el c&oacute;digo y se pega en el primer fotograma de el mc <em>ciudad<\/em> (Esto es temporal) y hacemos algunos cambios. el c&oacute;digo dentro de&nbsp; <em>ciudad<\/em> queda de la siguiente manera:<\/p>\n<p>[ftf]<\/p>\n<p>\/\/Quito la referencia a ciudad y dejo s\u00f3lo los valores _width y _height<br \/>\nvar centrex:Number = _width\/2;<br \/>\nvar centrey:Number = _height\/2;<br \/>\nvar xdist:Number = 0;<br \/>\nvar ydist:Number = 0;<br \/>\nvar xvect:Number = 0;<br \/>\nvar yvect:Number = 0;<br \/>\nvar persp:Number = -10;<br \/>\n\/\/Cambio la referencia a ciudad por un this ya que stamos en el mismo objeto<br \/>\nthis.onEnterFrame = function()<br \/>\n{<br \/>\n ydist = (_ymouse &#8211; centrey) \/ persp;<br \/>\n \/\/Cambio<br \/>\n yvect = yvect + ydist;<br \/>\n yvect = yvect * 0.9;<br \/>\n xdist = (_xmouse &#8211; centrex) \/ persp;<br \/>\n xvect = xvect + xdist;<br \/>\n xvect = xvect * 0.9;<br \/>\n \/\/Quito las referencias a &#8216;ciudad&#8217; y llamo directamente los mc<br \/>\n \/\/ya que estamos dentro del objeto<br \/>\n block1._y = (yvect &#8211; block1._y) * 0.03;<br \/>\n block2._y = (yvect &#8211; block2._y) * 0.02;<br \/>\n block3._y = (yvect &#8211; block3._y) * 0.01;<br \/>\n block1._x = (xvect &#8211; block1._x) * 0.45;<br \/>\n block2._x = (xvect &#8211; block2._x) * 0.30;<br \/>\n block3._x = (xvect &#8211; block3._x) * 0.15;<br \/>\n};<\/p>\n<p>[\/ftf]<\/p>\n<p>Partiendo de aqu&iacute; ya podemos <em>orientarnos a objetos. <\/em>Tenemos un objeto <em>ciudad <\/em>que tiene ciertas caracter&iacute;sticas, variables como <em>xdist<\/em> y funciones o m&eacute;todos como <em>onEnterFrame. <\/em>Est&aacute; claro que es un <em>MovieClip <\/em>lo cual es una clase de flash.<\/p>\n<p><strong>Crear una Clase:<\/strong><\/p>\n<p>Creamos un archivo llamado City.as, en este caso lo vamos a poner junto a nuestro fla y queda de la siguiente manera :<\/p>\n<p>[ftf]<\/p>\n<p>class City extends MovieClip<br \/>\n{<\/p>\n<p>}<\/p>\n<p>[\/ftf]<\/p>\n<p>La palabra reservada <em>class <\/em>nos indica que el archivo es una clase, seguido del nombre que va a llevar esa clase en este caso es <em>City <\/em>el cual debe de ser el mismo que el nombre del archivo y que por convenci&oacute;n se escribe con May&uacute;scula inicial. La palabra reservada <em>extends <\/em>nos indica que esta clase es una subclase o clase hija&nbsp;de <em>MovieClip <\/em>obedeciendo a otra caracter&iacute;stica m&aacute;s de la Orientaci&oacute;n a Objetos que es el <a href=\"http:\/\/es.wikipedia.org\/wiki\/Herencia_%28programaci%C3%B3n_orientada_a_objetos%29\" target=\"_blank\" title=\"Herencia\">Herencia<\/a>; algo as&iacute; como <em>class Perro extends Mam&iacute;fero<\/em>.<\/p>\n<p>El siguiente paso es algo sencillo, vamos a cortar el c&oacute;digo que tenemos dentro de nuestro mc <em>ciudad <\/em>y lo pegamos dentro del cuerpo de nuestra clase, esto no va a funcionar ya que todav&iacute;a hay que hacer unos cambios<\/p>\n<p>[ftf]<\/p>\n<p>class City extends MovieClip<br \/>\n{<\/p>\n<p> var centrex : Number = _width \/ 2;<br \/>\n var centrey : Number = _height \/ 2;<br \/>\n var xdist : Number = 0;<br \/>\n var ydist : Number = 0;<br \/>\n var xvect : Number = 0;<br \/>\n var yvect : Number = 0;<br \/>\n var persp : Number = &#8211; 10;<br \/>\n this.onEnterFrame = function ()<br \/>\n {<br \/>\n  ydist = (_ymouse &#8211; centrey) \/ persp;<br \/>\n  yvect = yvect + ydist;<br \/>\n  yvect = yvect * 0.9;<br \/>\n  xdist = (_xmouse &#8211; centrex) \/ persp;<br \/>\n  xvect = xvect + xdist;<br \/>\n  xvect = xvect * 0.9;<br \/>\n  block1._y = (yvect &#8211; block1._y) * 0.03;<br \/>\n  block2._y = (yvect &#8211; block2._y) * 0.02;<br \/>\n  block3._y = (yvect &#8211; block3._y) * 0.01;<br \/>\n  block1._x = (xvect &#8211; block1._x) * 0.45;<br \/>\n  block2._x = (xvect &#8211; block2._x) * 0.30;<br \/>\n  block3._x = (xvect &#8211; block3._x) * 0.15;<br \/>\n };<\/p>\n<p>}<\/p>\n<p>[\/ftf]<\/p>\n<p>En teor&iacute;a ya tenemos nuestra clase, tiene variables y una funci&oacute;n, s&oacute;lo hay que cambiar ciertas cosas para que funcione porque si no el compilador nos va a marcar algunos errores. Primero que nada a todas las variables que estamos declarando al principio con la palabra reservada <em>var <\/em>vamos a antedederles la palabra reservada <em>private <\/em>al hacer esto nos estamos asegurando de que ninguna variable pueda ser accedida por otro objeto que no sea la instancia de la clase. El fragmento de c&oacute;digo queda as&iacute;:<\/p>\n<p>[ftf]<\/p>\n<p> private var centrex : Number = _width \/ 2;<br \/>\n private var centrey : Number = _height \/ 2;<br \/>\n private var xdist : Number = 0;<br \/>\n private var ydist : Number = 0;<br \/>\n private var xvect : Number = 0;<br \/>\n private var yvect : Number = 0;<br \/>\n private var persp : Number = &#8211; 10;<br \/>\n \/\/Declaramos nuestros mcs, todas los miembros deben de estarlo.<br \/>\n private var block1:MovieClip;<br \/>\n private var block2:MovieClip;<br \/>\n private var block3:MovieClip;<\/p>\n<p>[\/ftf]<\/p>\n<p>y ahora s&oacute;lo nos falta declarar correctamente nuestra funci&oacute;n; las funciones o m&eacute;todos son, al igual que las variables, miembros de una clase, por lo tanto pueden ser publicas o privadas tambi&eacute;n. En este caso nuestra funci&oacute;n va a ser privada. Al ser esta una funci&oacute;n que existe previamente en la clase <em>MovieClip <\/em>(todos los mc la tienen)&nbsp; se dice que estamos <em>sobreescribiendo <\/em>el m&eacute;todo <em>onEnterFrame<\/em> de <em>MovieClip<\/em>&nbsp;es algo similar a cuando hacemos <em>onEnterFrame = unMetodo <\/em>estamos sobreescribiendo la funci&oacute;n que se ejecuta cada que pasamos por un frame dentro del mc. El fragmento de c&oacute;digo de de la funci&oacute;n quedar&iacute;a de la siguiente manera :<\/p>\n<p>[ftf]<\/p>\n<p>private function onEnterFrame ()<br \/>\n {<br \/>\n  ydist = (_ymouse &#8211; centrey) \/ persp;<br \/>\n  yvect = yvect + ydist;<br \/>\n  yvect = yvect * 0.9;<br \/>\n  xdist = (_xmouse &#8211; centrex) \/ persp;<br \/>\n  xvect = xvect + xdist;<br \/>\n  xvect = xvect * 0.9;<br \/>\n  \/\/Quito las referencias a &#8216;ciudad&#8217; y llamo directamente los mc<br \/>\n  \/\/ya que estamos dentro del objeto<br \/>\n  block1._y = (yvect &#8211; block1._y) * 0.03;<br \/>\n  block2._y = (yvect &#8211; block2._y) * 0.02;<br \/>\n  block3._y = (yvect &#8211; block3._y) * 0.01;<br \/>\n  block1._x = (xvect &#8211; block1._x) * 0.45;<br \/>\n  block2._x = (xvect &#8211; block2._x) * 0.30;<br \/>\n  block3._x = (xvect &#8211; block3._x) * 0.15;<br \/>\n };<\/p>\n<p>[\/ftf]<\/p>\n<p><strong>Constructor<\/strong><\/p>\n<p>Para tener nuestra clase terminada s&oacute;lo nos falta un peque&ntilde;o detalle. Las variables <em>centrex <\/em>y <em>centrey <\/em>al ejecutarse <em>onEnterFrame <\/em>son <em>null <\/em>debido a que se est&aacute;n inicializando tomado el ancho y el largo del mc pero el acho y el largo no existen ya que los mc se dibujan despu&eacute;s de que ha cargado el c&oacute;digo de la clase (peque&ntilde;o detalle) as&iacute; que lo que vamos a hacer es inicializar esas variables dentro de un m&eacute;todo de la clase al cual se le llama <a href=\"http:\/\/es.wikipedia.org\/wiki\/Constructor\" target=\"_blank\" title=\"Constructor\">Constructor<\/a>&nbsp;el cual se ejecuta en cuanto de crea la instancia de la clase y se llama exactamente igual que la clase (con todo y la may&uacute;scula inicial); el c&oacute;digo del constructor queda as&iacute; :<\/p>\n<p>[ftf]<\/p>\n<p>private function City()<br \/>\n {<br \/>\n  centrex = _width \/ 2;<br \/>\n  centrey = _height \/ 2;<br \/>\n }<\/p>\n<p>[\/ftf]<\/p>\n<p>Een esta ocasi&oacute;n lo ponemos como privado ya que no se van a crear objetos din&aacute;micamente ( se explicar&aacute; luego).<\/p>\n<p>El c&oacute;digo en el archivo City.as queda de la siguiente manera :<\/p>\n<p>[ftf]<\/p>\n<p>class City extends MovieClip<br \/>\n{<br \/>\n private var centrex : Number;<br \/>\n private var centrey : Number;<br \/>\n private var xdist : Number = 0;<br \/>\n private var ydist : Number = 0;<br \/>\n private var xvect : Number = 0;<br \/>\n private var yvect : Number = 0;<br \/>\n private var persp : Number = &#8211; 10;<br \/>\n private var block1 : MovieClip;<br \/>\n private var block2 : MovieClip;<br \/>\n private var block3 : MovieClip;<br \/>\n private function City()<br \/>\n {<br \/>\n  centrex = _width \/ 2;<br \/>\n  centrey = _height \/ 2;<br \/>\n }<br \/>\n private function onEnterFrame ()<br \/>\n {<br \/>\n  ydist = (_ymouse &#8211; centrey) \/ persp;<br \/>\n  yvect = yvect + ydist;<br \/>\n  yvect = yvect * 0.9;<br \/>\n  xdist = (_xmouse &#8211; centrex) \/ persp;<br \/>\n  xvect = xvect + xdist;<br \/>\n  xvect = xvect * 0.9;<br \/>\n  block1._y = (yvect &#8211; block1._y) * 0.03;<br \/>\n  block2._y = (yvect &#8211; block2._y) * 0.02;<br \/>\n  block3._y = (yvect &#8211; block3._y) * 0.01;<br \/>\n  block1._x = (xvect &#8211; block1._x) * 0.45;<br \/>\n  block2._x = (xvect &#8211; block2._x) * 0.30;<br \/>\n  block3._x = (xvect &#8211; block3._x) * 0.15;<br \/>\n  trace(centrex)<br \/>\n };<\/p>\n<p>[\/ftf]<\/p>\n<p><strong>Linkage<\/strong><\/p>\n<p>Lo &uacute;nico que nos falta es relacionar esa clase con nuestro mc y esto es muy sencillo. Vamos a la librer&iacute;a de flash y hacemos <em>click derecho\/Linkage&#8230;<\/em>, aparecer&aacute; una ventana como esta:<\/p>\n<p><img loading=\"lazy\" src=\"http:\/\/d2phkobe5kpduw.cloudfront.net\/qlog\/wp-content\/uploads\/Linkage.jpg\" border=\"0\" alt=\"Ventana de Linkage\" title=\"Ventana de Linkage\" width=\"525\" height=\"263\" \/><\/p>\n<p>Como podemos verindicamos en la caja de texto <em>Class: <\/em>el nombre de nuestra clase, flash al compilar buscara el archivo autom&aacute;ticamente. Presionamos OK y publicamos nuestra pel&iacute;cula. Si todo se hizo bien el resultado debe de ser el mismo.<\/p>\n<p><strong>Optimizaci&oacute;n<\/strong><\/p>\n<p>Por &uacute;ltimo me d&iacute; a la tarea de optimizar un poco el c&oacute;digo y quedo as&iacute; :<\/p>\n<p>[ftf]<\/p>\n<p>class City extends MovieClip<br \/>\n{<br \/>\n private var centrex : Number;<br \/>\n private var centrey : Number;<br \/>\n private var xdist : Number = 0;<br \/>\n private var ydist : Number = 0;<br \/>\n private var xvect : Number = 0;<br \/>\n private var yvect : Number = 0;<br \/>\n private var perspy : Number = &#8211; 10;<br \/>\n private var perspx : Number = 0.9;<br \/>\n private var block1 : MovieClip;<br \/>\n private var block2 : MovieClip;<br \/>\n private var block3 : MovieClip;<br \/>\n private function City()<br \/>\n {<br \/>\n  centrex = _width \/ 2;<br \/>\n  centrey = _height \/ 2;<br \/>\n }<br \/>\n private function onEnterFrame ()<br \/>\n {<br \/>\n  ydist = (_ymouse &#8211; centrey) \/ perspy;<br \/>\n  xdist = (_xmouse &#8211; centrex) \/ perspy;<br \/>\n  yvect += ydist;<br \/>\n  xvect += xdist;<br \/>\n  yvect *= perspx;<br \/>\n  xvect *= perspx;<br \/>\n  move(xvect, yvect);<br \/>\n };<br \/>\n private function move(xv:Number, yv:Number)<br \/>\n {<br \/>\n  block1._y = (yv &#8211; block1._y) * 0.03;<br \/>\n  block2._y = (yv &#8211; block2._y) * 0.02;<br \/>\n  block3._y = (yv &#8211; block3._y) * 0.01;<br \/>\n  block1._x = (xv &#8211; block1._x) * 0.45;<br \/>\n  block2._x = (xv &#8211; block2._x) * 0.30;<br \/>\n  block3._x = (xv &#8211; block3._x) * 0.15;<br \/>\n }<br \/>\n}<\/p>\n<p>[\/ftf]<\/p>\n<p>Como comentario final me gustar&iacute;a mencionar que la Orientaci&oacute;n a Objetos no es un tema complicado para lo que se necesite alg&uacute;n tipo de genio matem&aacute;tico-l&oacute;gico-booleano, de hecho es bastante sencillo&nbsp;y hay mucha informaci&oacute;n al respecto; de hecho es m&aacute;s sencillo que la programaci&oacute;n procedural partiendo de la premisa que es el esquema de pensamiento que usa el ser humano para concebir y describir su universo.<\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Esta es la respuesta a este post de flashla&nbsp; La orientaci&oacute;n a objetos es s&oacute;lo para que el c&oacute;digo sea m&aacute;s ordenado, legible y se acerque m&aacute;s a la manera en la que el ser humano concibe la realidad, asi que para transformar tu c&oacute;digo vamos a seguir algunos pasos b&aacute;sicos que s&oacute;lo requieren orden, [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[7,1],"tags":[],"_links":{"self":[{"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/posts\/28"}],"collection":[{"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/comments?post=28"}],"version-history":[{"count":0,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/posts\/28\/revisions"}],"wp:attachment":[{"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/media?parent=28"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/categories?post=28"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/tags?post=28"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}