{"id":320,"date":"2012-08-06T17:03:22","date_gmt":"2012-08-06T22:03:22","guid":{"rendered":"http:\/\/www.quantium.com.mx\/?p=320"},"modified":"2014-02-26T16:13:08","modified_gmt":"2014-02-26T22:13:08","slug":"nodejs","status":"publish","type":"post","link":"http:\/\/www.quantium.com.mx\/2012\/08\/06\/nodejs\/","title":{"rendered":"Como funciona Node.js"},"content":{"rendered":"<p style=\"text-align: center;\"><a href=\"http:\/\/d2phkobe5kpduw.cloudfront.net\/wp-content\/uploads\/2012\/08\/nodejs-1024x768.png\"><img loading=\"lazy\" class=\"aligncenter  wp-image-436\" alt=\"NodeJS\" src=\"http:\/\/d2phkobe5kpduw.cloudfront.net\/wp-content\/uploads\/2012\/08\/nodejs-1024x768.png\" width=\"614\" height=\"461\" \/><\/a><\/p>\n<p><a title=\"node.js\" href=\"http:\/\/nodejs.org\/\" target=\"_blank\">Node.js<\/a>, en resumidas cuentas, es una plataforma para utilizar <a href=\"http:\/\/en.wikipedia.org\/wiki\/Javascript\" target=\"_blank\">javascript<\/a> del lado del servidor, se podr\u00eda decir, aunque no de manera muy exacta, que hace las veces de php, asp o jsp.<\/p>\n<p><!--more--><\/p>\n<p><a title=\"Fuente Wikipedia\" href=\"http:\/\/en.wikipedia.org\/wiki\/File:Scheme_dynamic_page_en.svg\" target=\"_blank\"><img loading=\"lazy\" class=\"alignnone\" title=\"Server side\" alt=\"tomado de Wikipedia\" src=\"http:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/4\/4f\/Scheme_dynamic_page_en.svg\/800px-Scheme_dynamic_page_en.svg.png\" width=\"628\" height=\"204\" \/><\/a><\/p>\n<p>Y digo que no de manera muy exacta porque cada lenguaje tiene sus restricciones, por ejemplo <a title=\"php\" href=\"http:\/\/www.php.net\/\" target=\"_blank\">php<\/a> est\u00e1 planeado para ser un script interpretable que depende de un servidor web como <a title=\"Apache\" href=\"http:\/\/httpd.apache.org\/\" target=\"_blank\">apache<\/a> o <a title=\"IIS\" href=\"http:\/\/www.iis.net\/\" target=\"_blank\">iis<\/a>. Node hace las veces de un c\u00f3digo y de un servidor web, pudi\u00e9ndose correr sin depender de uno u otro.<\/p>\n<p><img loading=\"lazy\" title=\"Google V8\" alt=\"V8 googles javascript engine \" src=\"http:\/\/code.google.com\/p\/v8\/logo?cct=1338820848\" width=\"63\" height=\"55\" \/>Node utiliza la <a title=\"Google V8\" href=\"http:\/\/code.google.com\/p\/v8\/\" target=\"_blank\">m\u00e1quina virtual de javascript de google conocida como v8<\/a> para interpretar el c\u00f3digo javascript. La segunda caracter\u00edstica m\u00e1s notable es que puede levantar servidores web en casi cualquier puerto que se le indique y generar llamadas tipo <a title=\"comet\" href=\"http:\/\/es.wikipedia.org\/wiki\/Comet\" target=\"_blank\">comet<\/a>, osea que son conexiones persistentes que se comportan como sockets y que hacen posible la comunicaci\u00f3n \u00fanica bidirideccional entre el cliente y el servidor.<\/p>\n<p>Para poner esto m\u00e1s claro, en php, por ejemplo, llamamos un archivo .php y, despu\u00e9s de un procesamiento en el servidor, obtenemos un archivo de texto, una imagen o cualquier otro tipo de archivo, dependiendo de como est\u00e9 programado; pero siempre, siempre, al final del archivo un <a title=\"End Of File\" href=\"http:\/\/es.wikipedia.org\/wiki\/EOF\">EOF<\/a> o Fin De Archivo (Por sus siglas en ingl\u00e9s) que nos indica que la conexi\u00f3n se cerr\u00f3. (PHP tambi\u00e9n es capaz de generar <a title=\"PHP Sockets\" href=\"http:\/\/php.net\/manual\/en\/book.sockets.php\" target=\"_blank\">conexiones persistentes<\/a> con <a title=\"otras t\u00e9cnicas\" href=\"http:\/\/jsjoy.com\/blog\/197\/simple-php-comet-example?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=simple-php-comet-example\" target=\"_blank\">diferentes t\u00e9cnicas<\/a> aunque inicialmente no fue planeado para ello), si se quieren obtener m\u00e1s datos del servidor hay que hacer otra petici\u00f3n, el servidor no puede <em>simplemente enviar<\/em> los datos al cliente.<\/p>\n<p>Mientras que una conexi\u00f3n tipo <a title=\"comet\" href=\"http:\/\/es.wikipedia.org\/wiki\/Comet\" target=\"_blank\">comet<\/a> o persistente no env\u00eda el <a title=\"End Of File\" href=\"http:\/\/es.wikipedia.org\/wiki\/EOF\">EOF<\/a> y eso hace que la conexi\u00f3n no se cierre y el servidor pueda enviar de manera <a title=\"Transmisi\u00f3n as\u00edncrona\" href=\"http:\/\/es.wikipedia.org\/wiki\/Transmisi%C3%B3n_as%C3%ADncrona\" target=\"_blank\">as\u00edncrona<\/a> al cliente los datos que sean necesarios. Esto nos sirve para hacer juegos, chats y push de bigdata en clientes web sin tener que refrescar el sitio y de manera fluida, aunque utiliza mucho ancho de banda y las dem\u00e1s aplicaciones que corran junto a la nuestra pueden verse afectadas.<\/p>\n<h2>Ventajas<\/h2>\n<ul>\n<li>Se programa en javascript as\u00ed que la curva de aprendizaje es m\u00ednima<\/li>\n<li>Levantar un servidor es muy facil<\/li>\n<li>Tiene un api sencillo de aprender y no muy grande<\/li>\n<li>Tiene <a title=\"npm.js\" href=\"https:\/\/npmjs.org\/\" target=\"_blank\">su propio repositorio de m\u00f3dulos<\/a> y es sencillo de utilizar<\/li>\n<li>No crea un hilo por conexi\u00f3n y duerme mientras no se utiliza<\/li>\n<li>Tiene un int\u00e9rprete en l\u00ednea de comandos<\/li>\n<\/ul>\n<p>No hablar\u00e9 de las desventajas ya que estos temas tienen a ser muy pol\u00e9micos, pero s\u00ed dir\u00e9 que est\u00e1 en su versi\u00f3n 0.8.5 lo cual nos indica que sigue en beta, aunque bastante robusto la mayor\u00eda, hay ciertas cosas que a\u00fan falta probar.<\/p>\n<h2>Como se usa<\/h2>\n<p>Para crear un servidor a la escucha s\u00f3lo escribimos un archivo llamado hola_edmundo.js<\/p>\n<pre> var http = require('http');\r\nvar server = http.createServer(function(request,response)\r\n{\r\nresponse.writeHead(200);\r\nresponse.end('Hola Edmundo,\u00a0 Como est\u00e1n los ni\u00f1os?');\r\n\/\/2 de mis primos se llaman Edmundo y niguno tiene hijos\r\nconsole.log(\"Request url :: \" + request.url);\r\n});\r\nserver.listen(8080);\r\n<\/pre>\n<p><strong>Para correrlo<\/strong> basta ejecutar el comando node hola_edmundo.js<\/p>\n<p><strong>En la l\u00ednea 1<\/strong> estamos utilizando <em>require<\/em>, require es una funci\u00f3n de node para importar m\u00f3dulos, todo en node se basa en m\u00f3dulos; a mi parecer es una manera elegante y limpia de resolver la carencia de <a title=\"Object Oriented Programming\" href=\"http:\/\/en.wikipedia.org\/wiki\/Object-oriented_programming\" target=\"_blank\">OOP<\/a> en javascript, En esta l\u00ednea estamos importando el m\u00f3dulo http que nos permite crear servidores del tipo que su nombre indica.<\/p>\n<p><strong>En la l\u00ednea 2<\/strong> estamos utilizando la funci\u00f3n <em>createServer<\/em> que acepta una funci\u00f3n como par\u00e1metro opcional a modo de <em>listener<\/em> a la escucha el un evento; como en todo en <em>javascript<\/em> si no pasamos esta funci\u00f3n como par\u00e1metro se detendr\u00e1 la ejecuci\u00f3n del c\u00f3digo posterior hasta que no se haya terminado de crear el servidor. Esta funci\u00f3n recibe 2 par\u00e1metros, uno es el <em>request<\/em> o petici\u00f3n y el otro el <em>response<\/em> o respuesta.<\/p>\n<p><strong>En la l\u00ednea 4<\/strong> le estoy diciendo que escriba la cabecera con s\u00f3lo la opci\u00f3n de la respuesa <em>200<\/em>, osea <em>todo bien<\/em>.<\/p>\n<p><strong>En la l\u00ednea 5<\/strong> utilizo la funci\u00f3n end para indicar como va a terminar el programa, en este caso digo que escriba una frase muy ingeniosa que se me ocurri\u00f3 mientras escrib\u00eda este post. Esto es lo que se va a ver en el navegador.<\/p>\n<p><strong>En la l\u00ednea 7<\/strong> utilizo el la funci\u00f3n <em>log<\/em> del objeto <em>console<\/em> que no funciona igual que su hom\u00f3nimo del lado del cliente, aunque parecido, al ejecutar esta l\u00ednea y pasarle como par\u00e1metro <em>request.url<\/em> puedo ver que en cuanto alguien (o algo) hace una petici\u00f3n me mostrar\u00e1 el string url almacenado en el objeto request. El <em>request<\/em> es lo que el cliente est\u00e1 enviando al hacer la petici\u00f3n, por ejemplo, si mi c\u00f3digo est\u00e1 corriendo en localhost y yo pido http:\/\/localhost:8080\/chido_punketo_y_a_gogo al mostrar el url en mi terminal se mostrara lo siguiente:<\/p>\n<pre> \/chido_punketo_y_a_gogo\r\n<\/pre>\n<p>O el url que est\u00e9 yo siguiendo, esta es una muestra de que podemos hacer la petici\u00f3n que nuestro archivo js no est\u00e1 funcionando igual que un php que a cada petici\u00f3n es llamado e interpreta lo enviado y devuelve algo desado, es m\u00e1s bien como apache que se pone a la escucha y recibe todas las peticiones.<\/p>\n<p>Pens\u00e1ndo un poco podemos deducir que importando m\u00e1s m\u00f3dulos podemos hacer todo un \u00e1rbol de decisiones basados en la petici\u00f3n del usuario, o bien un socket para crear un chat.<\/p>\n<p>Y finalmente <strong>en la l\u00ednea 9<\/strong> inicializo el servidor para que escuche el puerto 8080.<\/p>\n<p>Pueden encontrar el c\u00f3digo de este peque\u00f1o ejemplo en mi <a title=\"C\u00f3digo en el github\" href=\"https:\/\/github.com\/Quantium\/lab\/blob\/master\/hello_http.js\" target=\"_blank\">github<\/a><\/p>\n<p>En los pr\u00f3ximos posts seguir\u00e9 escribiendo acerca de Node.js espero pronto poner un tutorial de instalaci\u00f3n y uso y algunos ejemplos pr\u00e1cticos.<\/p>\n<p>Har\u00e9 todo lo posible por narrar mi pr\u00f3ximo post como <a title=\"Bob Ross\" href=\"http:\/\/www.bobross.com\/\" target=\"_blank\">Bob Ross<\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Node.js, en resumidas cuentas, es una plataforma para utilizar javascript del lado del servidor, se podr\u00eda decir, aunque no de manera muy exacta, que hace las veces de php, asp o jsp.<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[7,97,98,79,44],"tags":[103,72,161,162,100,102,99],"_links":{"self":[{"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/posts\/320"}],"collection":[{"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/comments?post=320"}],"version-history":[{"count":27,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/posts\/320\/revisions"}],"predecessor-version":[{"id":438,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/posts\/320\/revisions\/438"}],"wp:attachment":[{"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/media?parent=320"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/categories?post=320"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/www.quantium.com.mx\/wp-json\/wp\/v2\/tags?post=320"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}